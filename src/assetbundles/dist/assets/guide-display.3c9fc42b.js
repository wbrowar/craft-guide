import{d as C,U as P,_ as L,r as i,s as A,x as R,l as v,c as f,t as b,u as p,b as O,B as $,a as M,e as _,k as T,o as g,M as q,y as B,V as U,w as F,L as V,P as x}from"./_plugin-vue_export-helper.d6f3a452.js";import{C as J,M as z,a as H,S as j}from"./Modal.95815eb1.js";const K=C({__name:"OnLoad",emits:["loaded"],setup(a,{emit:t}){return P(()=>{t("loaded")}),(n,o)=>null}}),Q=L(K,[["__file","/Users/wbrowar/CODE/craft_v4/craft-guide/_source/_assets/components/OnLoad.vue"]]),W={key:0},X={key:0},Y={key:0},Z={key:1},ee={key:1},te={key:0},ae={key:1},ne=C({__name:"PlacementInlineEditor",props:{placementId:String,placementInlineEditor:{type:String,required:!0}},setup(a){const t=a,n=i(),o=i(),u=i(!1);o.value={access:"all",group:"uiElement",groupId:t.placementInlineEditor,guideId:null,id:t.placementId?parseFloat(t.placementId):null,portalMethod:"append",selector:null,theme:"default",uri:null};const r=i(),c=A(()=>{const l=[{label:_["Select One"],value:"__none__"}];return T.forEach(s=>{l.push({label:s.title,value:s.slug})}),l});async function D(){var l,s;(l=o.value)!=null&&l.id&&await((s=window.Craft)==null?void 0:s.postActionRequest("guide/placement/delete-placement",{data:JSON.stringify(o.value)},(e,w,y)=>{var d,m,E,h;v("Deleting placement",e,w,y),u.value=!0,e.status==="success"?(m=(d=window.Craft)==null?void 0:d.cp)==null||m.displayNotice("Guide removed"):(h=(E=window.Craft)==null?void 0:E.cp)==null||h.displayError(e.data.error)}))}function I(l){n.value=l}function N(){n.value==="__none__"?D():S()}async function S(){var s;const l=T.find(e=>e.slug===n.value);o.value&&l&&(o.value.guideId=l.id),await((s=window.Craft)==null?void 0:s.postActionRequest("guide/placement/save-placement",{data:JSON.stringify(o.value)},(e,w,y)=>{var d,m,E,h;v("Saving placement",e,w,y),u.value=!0,e.status==="success"?(m=(d=window.Craft)==null?void 0:d.cp)==null||m.displayNotice("Guide UI element updated"):(h=(E=window.Craft)==null?void 0:E.cp)==null||h.displayError(e.data.error)}))}return R(()=>{r.value.setFieldValue(c.value[0].value),v("PlacementInlineEditor loaded")}),(l,s)=>a.placementInlineEditor?(g(),f("div",W,[u.value?(g(),f("div",X,[n.value==="__none__"?(g(),f("p",Y,b(p(_).PLACEMENT_INLINE_EDITOR_CONFIRM_REMOVED),1)):(g(),f("p",Z,b(p(_).PLACEMENT_INLINE_EDITOR_CONFIRM_ADDED),1))])):O("v-if",!0),!u.value&&p(q).useOrganizer?(g(),f("div",ee,[p(T).length?(g(),f("div",te,[$(J,{ref_key:"guideField",ref:r,instructions:p(_).PLACEMENT_INLINE_EDITOR_FIELD_INSTRUCTIONS_GUIDE,label:p(_).Guide,name:"guide",options:p(c),onValueChanged:I},null,8,["instructions","label","options"]),M("button",{class:"btn submit",type:"button",onClick:N},b(p(_).Save),1)])):(g(),f("div",ae,[M("p",null,b(p(_).PLACEMENT_INLINE_EDITOR_NO_GUIDES),1)]))])):O("v-if",!0)])):O("v-if",!0)}}),le=L(ne,[["__file","/Users/wbrowar/CODE/craft_v4/craft-guide/_source/_assets/components/PlacementInlineEditor.vue"]]),oe=C({name:"GuideDisplay",delimiters:["${","}"],components:{Modal:z,OnLoad:Q,PlacementInlineEditor:le,SvgGuide:H,SvgSettings:j}}),se=C({...oe,props:{enableInlineEditor:Boolean,guideDisplay:{type:String,required:!0},guideNavData:String,startInInlineEditor:{type:Boolean,required:!1},teleportContainerClass:String,teleportMethod:String,teleportSelector:String,teleportToSlideout:{type:Boolean,default:!1}},setup(a){const t=a,n=i(""),o=i({}),u=i(!1),r=i(t.guideNavData?JSON.parse(t.guideNavData):[]),c=i(""),D=i(!1),I=i(!1),N=i(!1);A(()=>t.teleportToSlideout?N.value:!0),A(()=>t.teleportToSlideout?t.teleportSelector:t.teleportSelector?`#teleport-${t.guideDisplay}`:null),B&&r.value.forEach(e=>{o.value[e.slug]={boolean1:!1,boolean2:!1,boolean3:!1,boolean4:!1,boolean5:!1,number1:0,number2:0,number3:0,number4:0,number5:0,string1:"",string2:"",string3:"",string4:"",string5:""}});function S(){c.value=window.location.hash.substr(1)}function l(e){v(`Turning TLDR: ${e?"on":"off"}`),I.value=e,document.querySelectorAll(".tldr-show").forEach(d=>{e?d.removeAttribute("hidden"):d.setAttribute("hidden","hidden")}),document.querySelectorAll(".tldr-hide").forEach(d=>{e?d.setAttribute("hidden","hidden"):d.removeAttribute("hidden")}),localStorage.setItem("guide:display:tldr",e?"true":"false")}function s(){if(n.value){const e=document.querySelector(`.guide-${n.value} .tldr-hide, .guide-${n.value} .tldr-show, .guide-${n.value} [class^="tldr:"]`);v(`.guide-${n.value}`,e),u.value=e!==null}}return P(()=>{var e;(e=r.value)!=null&&e.length&&(n.value=r.value[0].slug),D.value=t.startInInlineEditor}),R(()=>{s(),l(localStorage.getItem("guide:display:tldr")==="true"),window.addEventListener("hashchange",S),new window.Craft.Slideout('<div id="guide-slideout"></div>',{autoOpen:!1,containerAttributes:{class:"g-relative g-overflow-y-auto"}}),v("GuideDisplay loaded")}),U(()=>{window.removeEventListener("hashchange",S)}),F(n,()=>{V(()=>{s(),l(I.value)})}),()=>{}}});const k=L(se,[["__file","/Users/wbrowar/CODE/craft_v4/craft-guide/_source/_assets/components/GuideDisplay.vue"]]);const G=document.querySelectorAll("[data-guide-display]");G&&G.forEach(a=>{var t,n,o,u;if((t=a.dataset)!=null&&t.guideDisplay){if((n=a.dataset)!=null&&n.teleportSelector){const r=document.querySelector(a.dataset.teleportSelector);if(r){const c=document.createElement("div");c.id=`teleport-${a.dataset.guideDisplay}`,(o=a.dataset)!=null&&o.teleportContainerClass&&c.setAttribute("class",a.dataset.teleportContainerClass),((u=a.dataset)==null?void 0:u.teleportMethod)==="prepend"?r.insertBefore(c,r.firstChild):r.appendChild(c)}}k.template=`#${a.dataset.guideDisplay}`,x({...k},a.dataset).mount(a)}});
