import{d as N,U as G,r as s,q as A,s as $,y as m,c as f,t as b,u as p,b as O,B as q,a as M,e as g,k as T,o as _,M as R,x as P,V as B,w as F,L as V,P as U}from"./_plugin-vue_export-helper.ac984e31.js";import{_ as x,M as J,a as z,S as H}from"./Modal.e851e65d.js";const j=N({__name:"OnLoad",emits:["loaded"],setup(a,{emit:t}){return G(()=>{t("loaded")}),(n,o)=>null}}),K={key:0},Q={key:0},W={key:0},X={key:1},Y={key:1},Z={key:0},ee={key:1},te=N({__name:"PlacementInlineEditor",props:{placementId:String,placementInlineEditor:{type:String,required:!0}},setup(a){const t=a,n=s(),o=s(),u=s(!1);o.value={access:"all",group:"uiElement",groupId:t.placementInlineEditor,guideId:null,id:t.placementId?parseFloat(t.placementId):null,portalMethod:"append",selector:null,theme:"default",uri:null};const r=s(),c=A(()=>{const l=[{label:g["Select One"],value:"__none__"}];return T.forEach(i=>{l.push({label:i.title,value:i.slug})}),l});async function C(){var l,i;(l=o.value)!=null&&l.id&&await((i=window.Craft)==null?void 0:i.postActionRequest("guide/placement/delete-placement",{data:JSON.stringify(o.value)},(e,y,w)=>{var d,v,h,E;m("Deleting placement",e,y,w),u.value=!0,e.status==="success"?(v=(d=window.Craft)==null?void 0:d.cp)==null||v.displayNotice("Guide removed"):(E=(h=window.Craft)==null?void 0:h.cp)==null||E.displayError(e.data.error)}))}function I(l){n.value=l}function D(){n.value==="__none__"?C():S()}async function S(){var i;const l=T.find(e=>e.slug===n.value);o.value&&l&&(o.value.guideId=l.id),await((i=window.Craft)==null?void 0:i.postActionRequest("guide/placement/save-placement",{data:JSON.stringify(o.value)},(e,y,w)=>{var d,v,h,E;m("Saving placement",e,y,w),u.value=!0,e.status==="success"?(v=(d=window.Craft)==null?void 0:d.cp)==null||v.displayNotice("Guide UI element updated"):(E=(h=window.Craft)==null?void 0:h.cp)==null||E.displayError(e.data.error)}))}return $(()=>{r.value.setFieldValue(c.value[0].value),m("PlacementInlineEditor loaded")}),(l,i)=>a.placementInlineEditor?(_(),f("div",K,[u.value?(_(),f("div",Q,[n.value==="__none__"?(_(),f("p",W,b(p(g).PLACEMENT_INLINE_EDITOR_CONFIRM_REMOVED),1)):(_(),f("p",X,b(p(g).PLACEMENT_INLINE_EDITOR_CONFIRM_ADDED),1))])):O("",!0),!u.value&&p(R).useOrganizer?(_(),f("div",Y,[p(T).length?(_(),f("div",Z,[q(x,{ref_key:"guideField",ref:r,instructions:p(g).PLACEMENT_INLINE_EDITOR_FIELD_INSTRUCTIONS_GUIDE,label:p(g).Guide,name:"guide",options:p(c),onValueChanged:I},null,8,["instructions","label","options"]),M("button",{class:"btn submit",type:"button",onClick:D},b(p(g).Save),1)])):(_(),f("div",ee,[M("p",null,b(p(g).PLACEMENT_INLINE_EDITOR_NO_GUIDES),1)]))])):O("",!0)])):O("",!0)}}),ae=N({name:"GuideDisplay",delimiters:["${","}"],components:{Modal:J,OnLoad:j,PlacementInlineEditor:te,SvgGuide:z,SvgSettings:H}}),L=N({...ae,props:{enableInlineEditor:Boolean,guideDisplay:{type:String,required:!0},guideNavData:String,startInInlineEditor:{type:Boolean,required:!1},teleportContainerClass:String,teleportMethod:String,teleportSelector:String},setup(a){const t=a,n=s(""),o=s({}),u=s(!1),r=s(t.guideNavData?JSON.parse(t.guideNavData):[]),c=s(""),C=s(!1),I=s(!1),D=s(!1);A(()=>t.teleportMethod==="slideout"?D.value:!0),A(()=>t.teleportMethod==="slideout"?t.teleportSelector:t.teleportSelector?`#teleport-${t.guideDisplay}`:null),P&&r.value.forEach(e=>{o.value[e.slug]={boolean1:!1,boolean2:!1,boolean3:!1,boolean4:!1,boolean5:!1,number1:0,number2:0,number3:0,number4:0,number5:0,string1:"",string2:"",string3:"",string4:"",string5:""}});function S(){c.value=window.location.hash.substr(1)}function l(e){m(`Turning TLDR: ${e?"on":"off"}`),I.value=e,document.querySelectorAll(".tldr-show").forEach(d=>{e?d.removeAttribute("hidden"):d.setAttribute("hidden","hidden")}),document.querySelectorAll(".tldr-hide").forEach(d=>{e?d.setAttribute("hidden","hidden"):d.removeAttribute("hidden")}),localStorage.setItem("guide:display:tldr",e?"true":"false")}function i(){if(n.value){const e=document.querySelector(`.guide-${n.value} .tldr-hide, .guide-${n.value} .tldr-show, .guide-${n.value} [class^="tldr:"]`);m(`.guide-${n.value}`,e),u.value=e!==null}}return G(()=>{var e;(e=r.value)!=null&&e.length&&(n.value=r.value[0].slug),C.value=t.startInInlineEditor}),$(()=>{i(),l(localStorage.getItem("guide:display:tldr")==="true"),window.addEventListener("hashchange",S),new window.Craft.Slideout('<div id="guide-slideout"></div>',{autoOpen:!1,containerAttributes:{class:"g-relative g-overflow-y-auto"}}),m("GuideDisplay loaded")}),B(()=>{window.removeEventListener("hashchange",S)}),F(n,()=>{V(()=>{i(),l(I.value)})}),()=>{}}});const k=document.querySelectorAll("[data-guide-display]");k&&k.forEach(a=>{var t,n,o,u;if((t=a.dataset)!=null&&t.guideDisplay){if((n=a.dataset)!=null&&n.teleportSelector){const r=document.querySelector(a.dataset.teleportSelector);if(r){const c=document.createElement("div");c.id=`teleport-${a.dataset.guideDisplay}`,(o=a.dataset)!=null&&o.teleportContainerClass&&c.setAttribute("class",a.dataset.teleportContainerClass),((u=a.dataset)==null?void 0:u.teleportMethod)==="append"?r.appendChild(c):r.insertBefore(c,r.firstChild)}}L.template=`#${a.dataset.guideDisplay}`,U({...L},a.dataset).mount(a)}});
